# TODO - AxiumForge SDF Asteroids

## FASE 2: Visual Enhancements & Technical Polish

### 1. AxShot Screenshot System ✅ KOMPLET
**Reference:** docs/PROJECT/screenshots.md

- [X] Opret axforge/axshot.lua modul
- [X] Instance-based organization (screenshots/<instance_id>/)
- [X] Hotkey support (F12)
- [X] Filename templates med timestamp
- [X] Metadata support
- [X] LÖVE/LÖVR compatibility layer
- [X] Integration i main.lua
- [X] README opdatering med screenshot instruktioner

---

### 2. Display & Viewport System (Resolution Independence) ✅ KOMPLET
**Reference:** docs/PROJECT/projectv02.md Section 2A

#### 2.1 Virtual Resolution System
- [X] Opret src/core/viewport.lua
  - [X] Definér virtual base resolution (1920x1080)
  - [X] Calculate scaling factors based on window size
  - [X] viewport:getScale() - Return scale factor
  - [X] viewport:toVirtual(x, y) - Screen to virtual coordinates
  - [X] viewport:toScreen(x, y) - Virtual to screen coordinates
  - [X] viewport:applyTransform() - Set scaling transform for rendering

#### 2.2 Fullscreen System
- [X] Opret src/core/display.lua
  - [X] display:getMonitorResolution() - Detect monitor specs
  - [X] display:selectBestResolution() - Choose closest to 2K max
  - [X] display:setFullscreen(enabled) - Toggle fullscreen
  - [X] display:handleResize(w, h) - Window resize callback
  - [X] Support for multiple monitors

#### 2.3 Configuration Integration
- [X] Opdater conf.lua:
  - [X] Add fullscreen = true som default
  - [X] Add window.resizable = true
  - [X] Add window.highdpi = true for DPI support
  - [X] Default resolution 1920x1080

#### 2.4 DPI & Scaling Support
- [X] Implementer DPI detection:
  - [X] love.window.getDPIScale() integration
  - [X] Automatic DPI scaling via highdpi and usedpiscale
  - [X] Viewport handles all coordinate scaling

#### 2.5 Ultrawide Support
- [X] Letterboxing system for extreme aspect ratios (21:9, 32:9)
- [X] Viewport:drawLetterbox() renders black bars
- [X] Keep gameplay area centered og korrekt proportioner

#### 2.6 Integration & Testing
- [X] Integrer viewport system i main.lua
- [X] Update all rendering calls to use viewport transforms
- [X] Update settings.lua coordinates til virtual resolution
- [X] Test fullscreen toggle med F11 hotkey
- [X] Test window resize dynamisk
- [X] Screenshot system fixed (absolute paths)

---

### 3. 3D-Like Visual System (Pseudo-3D Shading)
**Reference:** docs/PROJECT/projectv02.md Section 5A

#### 3.0 Release Naming
- [ ] Rename public release branding from "AxiumForge" to a unique title (e.g., "2D Asteroid Defence" or similar) for store/release assets and notes.

#### 3.1 Lighting System
- [ ] Opret src/render/lighting.lua
  - [ ] Global light direction (from sun position)
  - [ ] lighting:setDirection(dx, dy) - Set light vector
  - [ ] lighting:calculateIntensity(nx, ny) - Calculate diffuse lighting
  - [ ] lighting:getRimLight(nx, ny) - Calculate rim lighting

#### 3.2 SDF Normals & Gradients
- [ ] Udvid src/render/draw_sdf.lua:
  - [ ] calculateNormal(sdf, x, y) - Compute SDF gradient
  - [ ] drawShadedCircleSDF() - Circle med lighting
  - [ ] drawShadedCompositeSDF() - Composite shapes med lighting
  - [ ] Apply diffuse shading baseret på normal og light direction

#### 3.3 Terminator Lines (Day/Night Boundaries)
- [ ] Implementer terminator rendering for planets:
  - [ ] calculateTerminator(planet, lightDir) - Find boundary
  - [ ] drawTerminatorGradient() - Smooth gradient mellem lit/unlit
  - [ ] Apply til Earth og planets i background

#### 3.4 Material Properties
- [ ] Opret src/data/materials.lua:
  - [ ] Definér material types (rock, metal, ice for meteors)
  - [ ] Properties: albedo, roughness, specular
  - [ ] Ship material: metal med high specular
  - [ ] Planet materials med farver og reflektivitet

---

### 4. Multi-Layer Background System (Deep Space Scene)
**Reference:** docs/PROJECT/projectv02.md Section 5A

#### 4.1 Star Field Layer (Deepest)
- [ ] Opret src/render/starfield.lua:
  - [ ] Generate 3 size layers: tiny, medium, large stars
  - [ ] SDF-based star rendering (micro circles + noise)
  - [ ] Parallax factors: 0.02 (tiny), 0.05 (medium), 0.1 (large)
  - [ ] Optional galactic fog (procedural gradient/noise)
  - [ ] starfield:update(shipX, shipY) - Parallax tracking
  - [ ] starfield:draw() - Render all star layers

#### 4.2 Distant Solar System Layer
- [ ] Udvid src/render/background.lua:
  - [ ] Position sun low in background (asymmetric composition)
  - [ ] Sun surface turbulence (rotating noise pattern)
  - [ ] Tone down sun intensity to 30-40% brightness
  - [ ] Add 2-3 iconic planets:
    - [ ] Jupiter (banded atmosphere SDF pattern)
    - [ ] Saturn (with ring system - SDF ring + alpha falloff)
    - [ ] Mars (reddish coloration)
  - [ ] Planets rendered at 30-40% brightness
  - [ ] Very slow orbital animation (long periods)

#### 4.3 Earth Layer (Mid-Background)
- [ ] Implementer Earth rendering:
  - [ ] Large SDF sphere (partial visibility - bottom 70% only)
  - [ ] Procedural continent shapes (noise-based SDF islands)
  - [ ] Cloud layer overlay (separate noise with alpha)
  - [ ] Terminator line med day/night shading
  - [ ] Earth should be recognizable but toned down
  - [ ] Position nederst i billedet (horizon-like)

#### 4.4 Camera Perspective (15-20° Angle)
- [ ] Implementer perspective system:
  - [ ] Orbits skal være ellipser (ikke cirkler)
  - [ ] Scale planets based på dybde (smaller = further)
  - [ ] Y-offset for planets baseret på orbit depth
  - [ ] Maintain round SDF circles for planet shapes
  - [ ] Only orbit paths are perspective-projected

#### 4.5 Toning & Color Balance
- [ ] Adjust all background layers:
  - [ ] Background = 30-50% lysstyrke
  - [ ] Gameplay objects = 100% lysstyrke + skarpe konturer
  - [ ] Ensure baggrund distraherer ikke fra gameplay
  - [ ] Test contrast ratios for readability

---

### 5. Meteor Visual Enhancements (3D-Like Surface)
**Reference:** docs/PROJECT/projectv02.md Section 5

#### 5.1 Surface Detail System
- [ ] Opret src/render/meteor_surface.lua:
  - [ ] Procedural crater generation (small SDF circles)
  - [ ] Surface bumps/irregularities (noise-based)
  - [ ] Crack patterns (line SDF with glow)
  - [ ] meteorSurface:generate(meteorType) - Create detail primitives

#### 5.2 Meteor Shading
- [ ] Udvid src/entities/meteor.lua:
  - [ ] Apply lighting system to meteor surface
  - [ ] Calculate normals from SDF gradient
  - [ ] Rim light på bagside (backlit fra solen)
  - [ ] Diffuse shading based on light direction
  - [ ] Darker side away from sun

#### 5.3 Material Variations
- [ ] Implementer forskellige meteor materials:
  - [ ] Rocky (grey/brown, rough surface)
  - [ ] Metallic (reflective, sharper highlights)
  - [ ] Icy (blue tint, high specular)
  - [ ] Assign materials i sdf_meteors.lua definitions

---

### 6. Ship Visual Enhancements (Metallic Look)
**Reference:** docs/PROJECT/projectv02.md Section 5

#### 6.1 Multi-Layer Ship Rendering
- [ ] Udvid src/entities/ship.lua:
  - [ ] Separate SDF layers for:
    - [ ] Hull/body (main triangle shape)
    - [ ] Cockpit (glass-like overlay)
    - [ ] Panels/details (surface details)
    - [ ] Engine glow (thruster exhaust)
  - [ ] Each layer with different material properties

#### 6.2 Ship Shading & Highlights
- [ ] Apply lighting system til ship:
  - [ ] Metal material med high specular
  - [ ] Sharp highlights along edges
  - [ ] Rim light effect
  - [ ] Cockpit glass reflection/refraction effect

#### 6.3 Thruster Effects
- [ ] Enhanced thrust visualization:
  - [ ] Animated flame shape (SDF-based)
  - [ ] Heat distortion effect (optional)
  - [ ] Particle trail (small glowing dots)
  - [ ] Varies with thrust intensity

---

### 7. Advanced Railgun Effects
**Reference:** docs/PROJECT/projectv02.md

#### 7.1 Screen Shake
- [ ] Opret src/render/camera.lua:
  - [ ] camera:shake(intensity, duration)
  - [ ] Random offset generation
  - [ ] Exponential decay
  - [ ] Apply offset til all rendering
  - [ ] Trigger ved railgun fire

#### 7.2 Enhanced Beam Effects
- [ ] Udvid railgun visual system:
  - [ ] Lens flare ved muzzle flash
  - [ ] Star spikes (cross pattern)
  - [ ] Heat shimmer along beam path
  - [ ] Enhanced impact flash med radial burst

#### 7.3 Particle System
- [ ] Opret src/render/particles.lua:
  - [ ] Particle pool system
  - [ ] SDF-based particle rendering
  - [ ] Debris particles ved impact
  - [ ] Dust/smoke trails
  - [ ] Spark effects ved fragmentation

---

### 8. Performance Optimization

#### 8.1 SDF Rendering Optimization
- [ ] Profile rendering performance:
  - [ ] Identify hot paths i draw_sdf.lua
  - [ ] Cache SDF calculations hvor muligt
  - [ ] Implement distance-based LOD for distant objects
  - [ ] Reduce glow layers for small meteors

#### 8.2 Physics Optimization
- [ ] Box2D performance tuning:
  - [ ] Adjust velocity/position iterations
  - [ ] Implement spatial partitioning hvis nødvendigt
  - [ ] Pool og reuse Box2D bodies

#### 8.3 Memory Management
- [ ] Audit memory usage:
  - [ ] Proper cleanup af destroyed entities
  - [ ] Particle system pooling
  - [ ] Texture/canvas reuse

---

### 9. Polish & Tuning

#### 9.1 Visual Balance
- [ ] Test alle visual enhancements sammen:
  - [ ] Verify background ikke distraherer
  - [ ] Check contrast ratios
  - [ ] Validate læsbarhed af UI
  - [ ] Test på forskellige skærmstørrelser

#### 9.2 Gameplay Balance
- [ ] Tune difficulty progression:
  - [ ] Dynamic spawn rate baseret på score
  - [ ] Meteor size distribution
  - [ ] Railgun power scaling (optional)
  - [ ] Protected zone size adjustment

#### 9.3 Reference Validation
- [ ] Compare med assets/references/ billeder:
  - [ ] Match SDF visual style
  - [ ] Verify glow effects
  - [ ] Check surface detail fidelity
  - [ ] Ensure authentic TSDF look

---

### 10. Documentation Updates

- [ ] Opdater README.md:
  - [ ] Document resolution support (up to 2K)
  - [ ] Fullscreen instructions
  - [ ] Visual enhancements beskrivelse
  - [ ] Updated screenshots

- [ ] Opdater CHANGELOG:
  - [ ] All FASE 2 features
  - [ ] Performance improvements
  - [ ] Visual enhancements

- [ ] Opdater TODO:
  - [ ] Mark completed FASE 2 tasks
  - [ ] Note erfaringer og learnings

---

## Næste Skridt

Start med FASE 2, sektion 2: **Display & Viewport System**
Dette er fundamentet for resolution-independence og fullscreen support.
