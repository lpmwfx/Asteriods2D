# CHANGELOG - AxiumForge SDF Asteroids

All notable changes to this project will be documented in this file.

## [Unreleased]

### [2025-12-01] - FASE 2: Display & Viewport System (Resolution Independence)

#### Added
- **Virtual Resolution System** (`src/core/viewport.lua`):
  - Virtual base resolution of 1920x1080 (Full HD)
  - Automatic scaling to any actual window/screen size
  - Coordinate transformation: `toVirtual()` and `toScreen()`
  - Letterbox/pillarbox support for aspect ratio preservation
  - Uniform scaling maintains correct proportions
  - All game logic now uses virtual coordinates

- **Fullscreen Management** (`src/core/display.lua`):
  - Automatic monitor resolution detection
  - Smart resolution selection (up to 2560x1440 max)
  - Borderless fullscreen ("desktop" mode) for fast switching
  - Multiple monitor support
  - DPI scale detection and integration
  - Ultrawide aspect ratio detection (21:9, 32:9)

- **Configuration Updates** (`conf.lua`):
  - Default fullscreen enabled
  - Window resizable enabled
  - High-DPI support enabled
  - Default resolution: 1920x1080
  - Minimum window size: 1280x720

- **Hotkey Controls**:
  - F11: Toggle fullscreen mode
  - F12: Screenshot (existing AxShot system)
  - Dynamic window resize support

#### Updated
- **settings.lua**: All coordinates scaled to virtual resolution (1920x1080)
  - Screen dimensions updated to 1920x1080
  - Spawn radius increased to 1400
  - Protected zone radius scaled to 225
  - Background elements scaled proportionally
  - All planets and orbits adjusted for new resolution

- **main.lua**: Viewport integration
  - Viewport and Display systems initialized
  - Transform applied/reset in draw loop
  - Window resize callback added
  - Fullscreen toggle hotkey (F11)
  - Letterbox rendering for aspect ratio mismatch

#### Fixed
- **AxShot Screenshot System**:
  - Screenshots now save to project directory (not LÖVE save dir)
  - Uses `pwd` command for correct working directory detection
  - LÖVE 11.x API compatibility (`captureScreenshot` callback)
  - Directory creation using OS commands
  - FileData encoding with io.open() for absolute path writing
  - **Programmatic Screenshot Support**:
    - CLI argument: `love . --screenshot` or `love . -s`
    - Auto-capture after 2 second delay
    - Auto-quit after screenshot taken
    - Works for both user (F12) and AI/automation (--screenshot)

#### Technical
- Resolution-independent rendering throughout
- Automatic scaling from 1280x720 to 2560x1440
- Aspect ratio preservation with letterboxing
- DPI-aware rendering on Retina displays
- All game logic independent of actual screen size

#### Testing
- Tested fullscreen toggle (F11)
- Window resize verified
- No visual glitches or errors
- Screenshots working correctly

### [2025-12-01] - MVP COMPLETE! (Sections 11-16)

#### Added
- **Protected Zone System**:
  - Collision detection for meteors crossing inner zone
  - Configurable penalty (instant game over or lose life)
  - Distance-based detection from screen center
  - Visual warning when breached

- **Ship-Meteor Collision Detection**:
  - Box2D collision callbacks registered in physics system
  - Ship takes damage and loses life on meteor impact
  - Meteor destroyed on collision with ship
  - Ship respawn system after losing life

- **Game Over System**:
  - Triggered when lives reach zero
  - Displays final score and meteors destroyed
  - Press SPACE to restart game
  - Clean state reset on restart

- **Ship Respawn**:
  - Respawns at center after losing life
  - Maintains remaining lives count
  - Full physics reset

- **Score System**:
  - +10 points per meteor destroyed
  - Score tracked and displayed in UI
  - Score persists until game over
  - Displayed in game over screen

- **README.md**:
  - Complete installation instructions
  - Control scheme documentation
  - Gameplay features overview
  - Technical architecture explanation
  - Project structure documentation
  - Development status and roadmap

#### Updated
- **TODO**: Added FASE 2 with advanced visual features from project.md
- **TODO**: All MVP sections (1-16) marked as complete
- **game_state.lua**: Complete collision and game over logic
- **UI**: Score display integrated with game state

#### Gameplay Features (All MVP Requirements Met!)
- ✅ Full game loop from menu to game over
- ✅ 3 lives with respawn system
- ✅ Protected zone defense mechanic
- ✅ Score tracking and display
- ✅ Complete collision detection
- ✅ Game over with restart functionality
- ✅ All controls responsive and functional

#### Technical Achievements
- Pure SDF rendering (zero bitmap assets)
- Box2D collision callbacks for all interactions
- Data-driven architecture throughout
- Modular, maintainable codebase
- Complete MVP scope from project.md delivered

#### Documentation
- README.md with complete usage guide
- TODO updated with FASE 2 advanced features
- CHANGELOG tracking all implementations
- Code comments throughout

#### Testing
- Full gameplay loop tested
- Collision detection verified
- Game over and respawn tested
- Score system validated
- No errors or crashes

#### Project Status: MVP COMPLETE ✅
All requirements from project.md Section 7 (MVP scope) delivered:
1. ✅ Grundloop i LÖVE
2. ✅ Rumskib med rotation + thrust
3. ✅ Meteor-spawn i ring
4. ✅ Railgun-skud + collision
5. ✅ SDF-datafil for meteorer
6. ✅ Baggrund med sol/planeter
7. ✅ README + TODO

#### Next Phase
FASE 2: Visual Enhancement
- 3D-lignende shading system
- Pseudo-3D rendering with normals
- Advanced solar system with terminators
- Multi-layer ship rendering
- See TODO for complete roadmap

### [2025-12-01] - Core Gameplay Implementation (Sections 5-8)

#### Added
- **Ship Entity** (`src/entities/ship.lua`):
  - Box2D polygon body (triangle shape) with physics
  - Rotation controls (left/right arrows)
  - Forward thrust with visual flame effect (up arrow)
  - Screen wrapping
  - SDF rendering with glow effect
  - Max speed limiting

- **Meteor Entity** (`src/entities/meteor.lua`):
  - SDF composite rendering from primitives data
  - Box2D circular collision body
  - Mass calculation from SDF volume and density
  - Damage accumulation system
  - TSDF fragmentation when damage threshold exceeded
  - Fragments inherit scaled SDF data and physics properties
  - Random angular velocity for rotation

- **Meteor Spawning System**:
  - Spawns meteors in ring outside screen
  - Random positions and velocities aimed at center
  - Configurable spawn rate and maximum count
  - Random meteor type selection (small, medium, large)

- **Railgun Weapon System** (`src/entities/railgun.lua`):
  - Instant-hit raycast collision detection
  - Penetrates through all objects in path
  - Cooldown timer between shots (1 second)
  - Applies damage to all hit meteors
  - Visual beam effects with fade-out animation
  - Impact flash effects at hit points
  - Space bar to fire

#### Updated
- **game_state.lua**: Integrated Ship, Meteor, and Railgun entities
- **main.lua**: UI now receives game state data (score, lives, meteor count, railgun cooldown)
- **ui.lua**: Displays real-time railgun cooldown bar

#### Gameplay Features
- Fully playable game loop:
  1. Press SPACE to start game
  2. Arrow keys to rotate and thrust ship
  3. SPACE to fire railgun at meteors
  4. Meteors fragment into smaller pieces when hit
  5. Fragments continue with realistic physics
- Animated background with orbiting planets
- Protected zone visualization (center circle)
- Real-time HUD with all game stats

#### Technical
- All entities use SDF rendering (no bitmap assets)
- Box2D physics for all objects
- Data-driven meteor definitions with 6 variants
- TSDF fragmentation with configurable parameters
- Penetrating raycast weapon system

#### Testing
- Full gameplay loop tested successfully
- No errors or crashes
- Ship controls responsive
- Meteors spawn and move correctly
- Railgun hits and fragments meteors as expected
- UI updates correctly

#### Next Steps
- Implement protected zone penalty system
- Add ship-meteor collision detection
- Polish and tuning (spawn rates, difficulty)
- Add game over conditions

### [2025-12-01] - Initial Project Structure

#### Added
- Project directory structure created:
  - `src/core/` - Core game systems
  - `src/entities/` - Game entities (ship, meteors, railgun)
  - `src/render/` - Rendering systems
  - `src/data/` - Data definitions and settings

- **Configuration Files**:
  - `conf.lua` - L�VE 11.5 configuration with 1280x720 window
  - `main.lua` - Main game loop with love.load(), love.update(dt), love.draw()

- **Core Systems** (`src/core/`):
  - `physics.lua` - Box2D physics world with zero gravity for space simulation
  - `input.lua` - Centralized keyboard input handling
  - `game_state.lua` - Game state management (menu, playing, paused, game_over)

- **Data Layer** (`src/data/`):
  - `settings.lua` - All game constants and parameters (data-driven architecture)
  - `sdf_meteors.lua` - SDF meteor definitions with 6 meteor variants (small, medium, large)

- **Rendering Systems** (`src/render/`):
  - `draw_sdf.lua` - SDF rendering functions (circles, composites, lines, polygons with glow)
  - `background.lua` - Animated solar system background with orbiting planets
  - `ui.lua` - HUD system (score, lives, meteor count, railgun cooldown, FPS)

- **Reference Documentation**:
  - `RAG` file with L�VE 2D documentation links for future reference

#### Technical Details
- L�VE version: 11.5
- Physics: Box2D with zero gravity (space environment)
- Graphics: Pure SDF rendering (no bitmap assets)
- Meter size: 64 pixels per meter

#### Testing
- Project successfully runs with `love .` command
- No errors in initialization
- Menu state displays correctly with background animation

#### Notes
- All code is in English as per project standards
- Documentation is in Danish
- Data-driven architecture: no hardcoded values in game logic
- Modular design with clear separation of concerns

#### Next Steps
- TODO section 1-4 completed (Project setup, Core Systems, Data Layer, SDF Rendering)
- Ready to implement entities (Ship, Meteor, Railgun) in next iteration
